% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_feature_based_pathway_enrichment.R
\name{perform_fpa}
\alias{perform_fpa}
\title{Perform Feature-based Pathway Analysis (FPA)}
\usage{
perform_fpa(
  feature_table_marker,
  feature_table_all,
  metabolite_database,
  column = c("rp", "hilic"),
  adduct.table = NULL,
  ms1.match.ppm = 25,
  rt.match.tol = 5,
  mz.ppm.thr = 400,
  threads = 3,
  include_hidden_metabolites = FALSE,
  metabolic_network,
  pathway_database
)
}
\arguments{
\item{feature_table_marker}{A data frame of marker features.}

\item{feature_table_all}{A data frame containing all features.}

\item{metabolite_database}{A metabolite database object containing metabolite spectra.}

\item{column}{Character vector specifying the chromatography column type. Default is `c("rp", "hilic")`.}

\item{adduct.table}{Optional data frame containing adduct information. Default is `NULL`.}

\item{ms1.match.ppm}{Numeric; mass tolerance for MS1 matching in parts per million (ppm). Default is `10`.}

\item{rt.match.tol}{Numeric; retention time tolerance threshold in seconds. Default is `5`.}

\item{mz.ppm.thr}{Numeric; M/Z tolerance threshold for filtering in ppm. Default is `400`.}

\item{threads}{Integer; number of threads to use for parallel processing. Default is `3`.}

\item{include_hidden_metabolites}{Logical; whether to include hidden metabolites. Default is `FALSE`.}

\item{metabolic_network}{A metabolic network object representing metabolic reactions.}

\item{pathway_database}{A pathway database object containing metabolic pathways.}
}
\value{
A list containing:
  - `metabolic_module_result`: A data frame with metabolic module information.
  - `final_metabolic_network`: A `tbl_graph` object representing the final metabolic network.
  - `annotation_table_final`: A data frame with final annotated features.
}
\description{
This function performs feature-based pathway analysis. It contains
metabolite annotation based on ms1, network-based metabolite filtering,
metabolic module identification.
}
