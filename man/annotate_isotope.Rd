% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_feature_based_pathway_enrichment.R
\name{annotate_isotope}
\alias{annotate_isotope}
\title{Annotate Isotopes for a Given Molecular Formula}
\usage{
annotate_isotope(
  formula = "C9H14N2O12P2",
  adduct = "M-H",
  charge = 1,
  mz = 402.9998,
  rt = 823.1462,
  peak.mz,
  peak.rt,
  rt.tol = 5,
  mz.tol = 15,
  max.isotope = 4
)
}
\arguments{
\item{formula}{Character. The molecular formula of the compound (e.g., `"C9H14N2O12P2"`).}

\item{adduct}{Character. The adduct ion type (e.g., `"M-H"`).}

\item{charge}{Numeric. The charge state of the ion. Default is `1`.}

\item{mz}{Numeric. The accurate mass-to-charge ratio (m/z) of the monoisotopic peak.}

\item{rt}{Numeric. The retention time (RT) of the compound in seconds.}

\item{peak.mz}{Numeric vector. Observed m/z values of peaks in the dataset.}

\item{peak.rt}{Numeric vector. Observed retention times (RT) of peaks in the dataset.}

\item{rt.tol}{Numeric. The retention time tolerance (in seconds) for matching peaks. Default is `5`.}

\item{mz.tol}{Numeric. The m/z tolerance (in ppm) for matching peaks. Default is `15`.}

\item{max.isotope}{Numeric. The maximum number of isotopes to consider. Default is `4`.}
}
\value{
A data frame containing:
  \item{peakIndex}{Index of the matched peak in the dataset.}
  \item{mzError.ppm}{Mass error (in ppm) between the observed and theoretical isotope peak.}
  \item{isotopes}{Label of the identified isotope (e.g., `[M+1]`, `[M+2]`).}
  \item{rtError.s}{Retention time error (in seconds).}

If no isotopic peaks are matched within the given tolerances, the function returns `NULL`.
}
\description{
This function identifies isotopic peaks for a given molecular formula and adduct,
matching them with observed peaks based on mass-to-charge ratio (m/z) and retention time (RT).
}
\details{
The function calculates the theoretical isotope distribution using `Rdisop::getMolecule()`
and then matches observed peaks based on m/z and RT tolerances. The function ensures that
at least the `[M+1]` isotope is present for a valid match.
}
